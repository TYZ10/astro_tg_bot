import logging

from aiogram import types, F

from . import BasicBotOperation


class RefSystemBot(BasicBotOperation):
    async def my_ref_handler(self, call: types.CallbackQuery):
        try:
            col_info = self.operation_db.COLUMNS_INFO

            count_user, count_point = self.operation_db.select_user_info_db(
                f"{col_info.referral_all_count_user}, "
                f"{col_info.referral_all_count_points_user}",
                call.from_user.id,
                many=True
            )
            await call.message.answer(
                text=f"""‚ú® –•–æ—á–µ—à—å –ø–æ–ª—É—á–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫—É –±–µ—Å–ø–ª–∞—Ç–Ω–æ? –£ –Ω–∞—Å –µ—Å—Ç—å –ø—Ä–æ—Å—Ç–∞—è –∏ —É–¥–æ–±–Ω–∞—è —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞, –∫–æ—Ç–æ—Ä–∞—è –ø–æ–º–æ–∂–µ—Ç —Ç–µ–±–µ —ç—Ç–æ —Å–¥–µ–ª–∞—Ç—å.

–ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
1Ô∏è‚É£ –ü–æ–ª—É—á–∏ —Å–≤–æ—é —É–Ω–∏–∫–∞–ª—å–Ω—É—é —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—É—é —Å—Å—ã–ª–∫—É –≤ –º–µ–Ω—é.
2Ô∏è‚É£ –û—Ç–ø—Ä–∞–≤—å –µ—ë –¥—Ä—É–∑—å—è–º –∏ —Ä–∞—Å—Å–∫–∞–∂–∏ –æ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è—Ö –±–æ—Ç–∞: –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≥–Ω–æ–∑—ã, –Ω–∞—Ç–∞–ª—å–Ω–∞—è –∫–∞—Ä—Ç–∞, –∞–Ω–∞–ª–∏–∑ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏ –∏ –º–Ω–æ–≥–æ–µ –¥—Ä—É–≥–æ–µ.
3Ô∏è‚É£ –ö–∞–∫ —Ç–æ–ª—å–∫–æ 2 —Ç–≤–æ–∏—Ö –¥—Ä—É–≥–∞ –ø–µ—Ä–µ–π–¥—É—Ç –ø–æ —Å—Å—ã–ª–∫–µ, –Ω–∞—á–Ω—É—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –±–æ—Ç–æ–º –∏ —Å–¥–µ–ª–∞—é—Ç —Ö–æ—Ç—è –±—ã –æ–¥–Ω—É –≥–µ–Ω–µ—Ä–∞—Ü–∏—é, —Ç–≤–æ—è –ø–æ–¥–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏!

–ß—Ç–æ –¥–∞—ë—Ç –ø–æ–¥–ø–∏—Å–∫–∞?

üóìÔ∏è –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –≥–æ—Ä–æ—Å–∫–æ–ø—ã –Ω–∞ –≤—ã–±—Ä–∞–Ω–Ω—ã–µ —Ç–æ–±–æ–π —Å—Ñ–µ—Ä—ã –∂–∏–∑–Ω–∏.
üîÑ –£–≤–µ–ª–∏—á–µ–Ω–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–µ–Ω–µ—Ä–∞—Ü–∏–π ‚Äî –¥–æ 8 –≤ –¥–µ–Ω—å –≤–º–µ—Å—Ç–æ 4.
–ß–µ–º –±–æ–ª—å—à–µ –¥—Ä—É–∑–µ–π —Ç—ã –ø—Ä–∏–≥–ª–∞—Å–∏—à—å, —Ç–µ–º –±–æ–ª—å—à–µ –±–æ–Ω—É—Å–æ–≤ –ø–æ–ª—É—á–∏—à—å! –î–µ–ª–∏—Å—å —Å–≤–æ–µ–π —Å—Å—ã–ª–∫–æ–π, –Ω–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∑–≤—ë–∑–¥–Ω—ã–º–∏ –ø–æ–¥—Å–∫–∞–∑–∫–∞–º–∏ –∏ –∏—Å–ø–æ–ª—å–∑—É–π –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞ –Ω–∞ –º–∞–∫—Å–∏–º—É–º. üåü

–í–∞—à–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞:
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤: {count_user}
–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ñ–µ—Ä–∞–ª–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏: {count_point}

<code>{self.config.URL_BOT}?start={call.from_user.id}</code>""",
                parse_mode="HTML",
                reply_markup=self.keyboard.main_menu_kb
            )
        except Exception as e:
            logging.error(e, exc_info=True)

    def create_router(self):
        self.router.callback_query.register(self.my_ref_handler,
                                    F.data == "üéÅ –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞")
